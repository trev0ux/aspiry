import{C as e,Ct as t,E as n,H as r,Mt as i,P as ee,Qt as a,W as o,Y as s,_ as c,c as l,ct as u,dt as d,ft as te,g as f,h as p,lt as m,m as h,t as ne,tn as g,ut as _,v,vt as re,w as y}from"./vendor/json-editor-vue-ddj4xtqm.js";import"./vendor/shiki-kunkft64.js";import{E as ie,Fn as b,Gn as x,Ht as S,Jn as ae,Nn as C,Pt as w,a as T,c as oe,f as se,j as E,jt as D,k as ce,kt as O,l as le,q as k,qn as A,tn as ue}from"#entry";import{t as de}from"./nselect-cmll6q59.js";import{t as j}from"./composables-g8w9dpc0.js";import{t as fe}from"./nlink-bsck6xne.js";import{t as pe}from"./filepath-item-osqp88cx.js";var M={class:`h-[48px] flex items-center justify-between gap1 px-3`},N={class:`w-full text-sm`},P=[`value`],F=[`onClick`],I={key:0,"h-full":``,"of-hidden":``,flex:`~ col`},L={border:`b base`,class:`h-[49px] flex flex-none items-center justify-between px-4 text-sm`},R={class:`flex items-center gap-4`},z={key:1},me=[`onKeyup`],he={key:0,op50:``},ge={key:1},_e={"font-bold":``},ve={"text-sm":``},B=n({__name:`StorageDetails`,async setup(n){let T,j,B=w(),V=b(),H=C(),U=t(``),W=t(``),G=O(`storage:current`,``),K=t(),q=O(`storage:file:state`,``),{data:J}=([T,j]=_(()=>D(`storageMounts`,()=>S.getStorageMounts())),T=await T,j(),T),{data:Y,refresh:X}=([T,j]=_(async()=>D(`storageKeys`,async()=>G.value?await S.getStorageKeys(G.value):[])),T=await T,j(),T);r(V.hook(`storage:key:update`,async(e,t)=>{if(!(!G.value||e.split(`:`)[0]!==G.value)&&(await X(),q.value===e)){if(t===`remove`)return H.replace({query:{storage:G.value}});await Q(q.value)}})),u(G,()=>{X(),q.value=``}),m(async()=>{if(!q.value){K.value=null;return}Q(q.value)}),ue(`keydown`,e=>{e.key===`s`&&(e.ctrlKey||e.metaKey)&&($(),e.preventDefault())});function Z(e){return e.replace(`${G.value}:`,``)}let ye=h(()=>Y.value?Y.value.filter(e=>e.includes(U.value)):[]);async function Q(e){let t=await S.getStorageItem(await k(),e);K.value={key:e,updatedKey:Z(e),editingKey:!1,content:t,updatedContent:t}}async function be(){if(!W.value||!G.value)return;let e=`${G.value}:${W.value}`;Y.value?.includes(e)||await S.setStorageItem(await k(),e,``),H.replace({query:{storage:G.value,key:e}}),W.value=``}async function $(){K.value&&(await S.setStorageItem(await k(),K.value.key,K.value.updatedContent),await Q(K.value.key))}async function xe(){!K.value||!G.value||(await S.removeStorageItem(await k(),K.value.key),K.value=null)}async function Se(){if(!K.value||!G.value)return;let e=`${G.value}:${K.value.updatedKey}`,t=await k();await S.setStorageItem(t,e,K.value.updatedContent),await S.removeStorageItem(t,K.value.key),H.replace({query:{storage:G.value,key:e}})}return(t,n)=>{let r=ce,u=de,m=oe,h=E,_=fe,b=ie,S=se,C=le,w=pe;return i(G)?(o(),f(C,{key:0,"storage-key":`tab-storage`},{left:d(()=>[p(`div`,M,[y(r,{icon:`carbon-chevron-left`,"ml--1":``,border:!1,onClick:n[0]||=e=>G.value=``}),p(`div`,N,[y(u,{modelValue:i(G),"onUpdate:modelValue":n[1]||=e=>re(G)?G.value=e:null,n:`primary`,icon:`carbon-data-base`},{default:d(()=>[(o(!0),v(l,null,s(i(J),(e,t)=>(o(),v(`option`,{key:t,value:t},g(t),9,P))),128))]),_:1},8,[`modelValue`])])]),y(m,{modelValue:U.value,"onUpdate:modelValue":n[2]||=e=>U.value=e,icon:`carbon-search`,placeholder:`Search...`,n:`primary sm`,border:`y x-none base! rounded-0`,class:`w-full py2 ring-0!`},null,8,[`modelValue`]),(o(!0),v(l,null,s(ye.value,e=>(o(),v(l,{key:e},[p(`button`,{block:``,"w-full":``,truncate:``,px2:``,py1:``,"text-start":``,"text-sm":``,"font-mono":``,class:a(e===K.value?.key?`text-primary n-bg-active`:`text-secondary hover:n-bg-hover`),onClick:t=>q.value=e},g(Z(e)),11,F),n[8]||=p(`div`,{"x-divider":``},null,-1)],64))),128)),y(m,{modelValue:W.value,"onUpdate:modelValue":n[3]||=e=>W.value=e,icon:`carbon-add`,placeholder:`key`,n:`sm`,border:`t-none x-none base! rounded-0`,class:`w-full py2 font-mono ring-0!`,onKeyup:A(be,[`enter`])},null,8,[`modelValue`])]),right:d(()=>[K.value?.key?(o(),v(`div`,I,[p(`div`,L,[p(`div`,R,[K.value.editingKey?(o(),f(m,{key:0,modelValue:K.value.updatedKey,"onUpdate:modelValue":n[4]||=e=>K.value.updatedKey=e,onKeyup:A(Se,[`enter`])},null,8,[`modelValue`])):(o(),v(`code`,z,[e(g(Z(K.value.key))+` `,1),y(h,{icon:`carbon-edit`,class:`cursor-pointer op50 hover:op100`,onClick:n[5]||=e=>K.value.editingKey=!0})])),K.value.editingKey?c(``,!0):(o(),f(r,{key:2,n:`green xs`,disabled:K.value.content===K.value.updatedContent,class:a({"border-green":K.value.content!==K.value.updatedContent}),onClick:$},{default:d(()=>[...n[9]||=[e(` Save `,-1)]]),_:1},8,[`disabled`,`class`]))]),p(`div`,null,[y(r,{n:`red xs`,onClick:xe},{default:d(()=>[...n[10]||=[e(` Delete `,-1)]]),_:1})])]),typeof K.value.content==`object`?(o(),f(i(ne),ee({key:0,modelValue:K.value.updatedContent,"onUpdate:modelValue":n[6]||=e=>K.value.updatedContent=e,class:[[i(B)===`dark`?`jse-theme-dark`:`light`],`json-editor-vue h-full of-auto text-sm outline-none`]},t.$attrs,{mode:`text`,"navigation-bar":!1,indentation:2,"tab-size":2}),null,16,[`modelValue`,`class`])):te((o(),v(`textarea`,{key:1,"onUpdate:modelValue":n[7]||=e=>K.value.updatedContent=e,placeholder:`Item value...`,class:`h-full of-auto p-4 text-sm font-mono outline-none`,onKeyup:A(ae($,[`ctrl`]),[`enter`])},null,40,me)),[[x,K.value.updatedContent]])])):(o(),f(S,{key:1},{default:d(()=>[y(b,{px6:``,py4:``},{default:d(()=>[n[12]||=e(` Select one key to start.`,-1),n[13]||=p(`br`,null,null,-1),n[14]||=e(`Learn more about `,-1),y(_,{href:`https://nitro.unjs.io/guide/storage`,n:`orange`,target:`_blank`},{default:d(()=>[...n[11]||=[e(` Nitro storage `,-1)]]),_:1})]),_:1})]),_:1}))]),_:1})):(o(),f(S,{key:1},{default:d(()=>[Object.keys(i(J)).length?(o(),v(`p`,he,` Select one storage to start: `)):(o(),v(`p`,ge,[n[16]||=e(` No custom storage defined in `,-1),n[17]||=p(`code`,null,`nitro.storage`,-1),n[18]||=e(`.`,-1),n[19]||=p(`br`,null,null,-1),n[20]||=e(` Learn more about `,-1),y(_,{href:`https://nitro.unjs.io/guide/storage`,n:`orange`,target:`_blank`},{default:d(()=>[...n[15]||=[e(` Nitro storage `,-1)]]),_:1})])),(o(!0),v(l,null,s(i(J),(e,t)=>(o(),f(b,{key:t,"min-w-80":``,"cursor-pointer":``,"p-4":``,"text-left":``,hover:`border-green`,onClick:e=>G.value=t},{default:d(()=>[p(`span`,_e,g(t),1),n[21]||=p(`br`,null,null,-1),p(`span`,ve,g(e.driver)+` driver`,1),n[22]||=p(`br`,null,null,-1),e.base?(o(),f(w,{key:0,"text-xs":``,filepath:e.base},null,8,[`filepath`])):c(``,!0)]),_:2},1032,[`onClick`]))),128))]),_:1}))}}}),V=Object.assign(B,{__name:`StorageDetails`}),H=n({__name:`storage`,setup(e){return(e,t)=>{let n=V,r=T;return o(),f(r,null,{default:d(()=>[y(n)]),_:1})}}});export{H as default};